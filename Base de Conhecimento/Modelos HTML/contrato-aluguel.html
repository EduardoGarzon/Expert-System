<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerar Contrato</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/docx@7.1.0/build/index.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            font-family: 'Times New Roman', Arial, sans-serif;
            font-size: 16px;
        }

        main {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #f0f0f0;
            padding: 20px;
        }

        #buttons {
            padding: 2rem;
        }

        #exportPDF,
        #exportDocx {
            padding: 0.5rem;
            font-weight: bold;
            font-family: monospace, sans-serif, Arial, Helvetica;
            cursor: pointer;
        }

        #contrato {
            margin-top: 1rem;
            width: 210mm;
            min-height: 297mm;
            background-color: white;
            padding: 2.55cm;
            box-shadow: 0 0 10px rgba(0, 0, 0);
            border: 1px solid #ddd;
            text-align: justify;
        }

        h1 {
            text-align: center;
            font-size: 18px;
            margin-bottom: 2rem;
        }

        h2 {
            text-align: left;
            margin-bottom: 0.5rem;
            margin-top: 2rem;
        }

        p,
        ul {
            margin-bottom: 1rem;
        }

        ul {
            margin-left: 1rem;
        }

        li {
            padding: 0.5rem;
        }

        #grifar {
            background-color: yellow;
        }
    </style>
</head>

<body>
    <main>
        <section id="buttons">
            <button id="exportPDF">Exportar para PDF</button>
            <button id="exportDocx">Exportar para DOCX</button>
        </section>

        <section id="contrato">
            <h1>CONTRATO DE LOCAÇÃO DE IMÓVEL</h1>

            <p>
                <strong>LOCADOR:</strong>
                <span id="grifar">
                    <strong>
                        [Nome completo ou razão social], [Nacionalidade], [Estado civil], [Profissão],
                        portador(a) do CPF/CNPJ nº [__________], residente e domiciliado(a) na [endereço completo].
                    </strong>
                </span>
            </p>
            
            <p>
                <strong>LOCATÁRIO:</strong>
                <span id="grifar">
                    <strong>
                        [Nome completo ou razão social], [Nacionalidade], [Estado civil], [Profissão],
                        portador(a) do CPF/CNPJ nº [__________], residente e na [endereço completo].
                    </strong>
                </span>
            </p>

            <p>
                <strong>
                    Têm entre si, de maneira justa e contratada,
                    o presente contrato de locação de imóvel,
                    que se regerá pelas cláusulas seguintes:
                </strong>
            </p>

            <h2>CLÁUSULA 1 – OBJETO DO CONTRATO</h2>
            <p>
                O presente contrato tem por objeto o imóvel localizado na <span id="grifar"><strong>[endereço completo]</strong></span>,
                de propriedade do LOCADOR, que o aluga ao LOCATÁRIO, 
                para fins de <span id="grifar"><strong>[residenciais/comerciais]</strong></span>,
                conforme o uso e destinação acordados entre as partes.
            </p>

            <h2>CLÁUSULA 2 – PRAZO DE LOCAÇÃO</h2>
            <p>
                O prazo de locação é de <span id="grifar"><strong>[XX] meses ou ano (AJUSTAR)</strong></span>,
                com início em <span id="grifar"><strong>[data de início]</strong></span> 
                e término em <span id="grifar"><strong>[data de término]</strong></span>,
                podendo ser renovado por iguais e sucessivos períodos mediante concordância das partes.
            </p>

            <h2>CLÁUSULA 3 – VALOR DO ALUGUEL E FORMA DE PAGAMENTO</h2>
            <p>
                O valor mensal do aluguel será de <span id="grifar"><strong>R$ [valor]</strong></span>, 
                a ser pago até <span id="grifar"><strong>o [dia] de cada mês (AJUSTAR)</strong></span>,
                mediante <span id="grifar"><strong>[forma de pagamento: transferência bancária, depósito, boleto, etc.]</strong></span>,
                na conta bancária de titularidade do LOCADOR,
                cujos dados bancários serão informados ao LOCATÁRIO no momento da assinatura deste contrato.
            </p>

            <h2>CLÁUSULA 4 – REAJUSTE DO ALUGUEL</h2>
            <p>
                O valor do aluguel será reajustado anualmente,
                com base <span id="grifar"><strong>no índice [IGP-M, IPCA, ou outro índice acordado]</strong></span>, ou,
                caso este índice se torne indisponível,
                por outro índice oficial que reflita a variação do poder de compra da moeda.
            </p>

            <h2>CLÁUSULA 5 – OBRIGAÇÕES DO LOCADOR</h2>
            <p>O LOCADOR se compromete a:</p>
            <ul>
                <li>Garantir ao LOCATÁRIO o uso pacífico do imóvel durante o prazo da locação;</li>
                <li>
                    Realizar os reparos necessários nas instalações do imóvel,
                    salvo danos causados pelo uso inadequado;
                </li>
                <li>Entregar o imóvel em condições de uso e habitabilidade, conforme acordado.</li>
            </ul>

            <h2>CLÁUSULA 6 – OBRIGAÇÕES DO LOCATÁRIO</h2>
            <p>O LOCATÁRIO se compromete a:</p>
            <ul>
                <li>Pagar pontualmente o aluguel e encargos da locação, conforme estabelecido na cláusula 3;</li>
                <li>Conservar o imóvel, realizando pequenos reparos necessários em decorrência de uso inadequado;</li>
                <li>Não sublocar, ceder ou emprestar o imóvel a terceiros sem a expressa autorização do LOCADOR.</li>
            </ul>

            <h2>CLÁUSULA 7 – GARANTIA LOCATÍCIA</h2>
            <p>
                Como garantia do cumprimento das obrigações assumidas neste contrato,
                o LOCATÁRIO apresenta <span id="grifar"><strong>[caução, fiança, seguro fiança, ou outra modalidade de garantia acordada]</strong></span> 
                no valor de <span id="grifar"><strong>R$ [valor]</strong></span>, 
                que poderá ser utilizado para cobrir eventuais danos ao imóvel ou inadimplência.
            </p>

            <h2>CLÁUSULA 8 - DA CONSERVAÇÃO, REFORMAS E BENFEITORIAS NECESSÁRIAS</h2>
            <ul>
                <li>Ao LOCATÁRIO recai a responsabilidade por zelar pela conservação, limpeza e segurança do imóvel.</li>
                <li>
                    As benfeitorias necessárias introduzidas pelo LOCATÁRIO,
                    ainda que não autorizadas pelo LOCADOR, bem como as úteis, desde que autorizadas,
                    serão indenizáveis e permitem o exercício do direito de retenção.
                    As benfeitorias voluptuárias não serão indenizáveis, podendo ser levantadas pelo LOCATÁRIO, 
                    finda a locação, desde que sua retirada não afete a estrutura e a substância do imóvel.
                </li>
                <li>
                    O LOCATÁRIO está obrigado a devolver o imóvel em perfeitas condições de limpeza,
                    conservação e pintura, quando finda ou rescindida esta avença,
                    conforme constante no termo de vistoria em anexo.
                </li>
                <li>
                    O LOCATÁRIO não poderá realizar obras que alterem ou modifiquem a estrutura do imóvel locado,
                    sem prévia autorização por escrito da LOCADORA.
                    No caso de prévia autorização, as obras serão incorporadas ao imóvel,
                    sem que caiba ao LOCATÁRIO qualquer indenização pelas obras ou retenção por benfeitorias.
                </li>
            </ul>

            <h2>CLÁUSULA 9 – RESCISÃO CONTRATUAL</h2>
            <p>
                Este contrato poderá ser rescindido por qualquer uma das partes mediante notificação prévia de 
                <span id="grifar"><strong>[X] dias</strong></span>, por escrito.
                Em caso de rescisão antecipada por parte do LOCATÁRIO,
                será devida uma multa <span id="grifar"><strong>equivalente a [valor ou percentual] do valor do aluguel
                mensal por cada mês restante do contrato. (AJUSTAR)</strong></span>
            </p>

            <h2>CLÁUSULA 10 – VISTORIA DO IMÓVEL</h2>
            <p>
                As partes realizarão, na data da assinatura deste contrato, uma vistoria detalhada do imóvel,
                que será documentada em relatório, com fotos e descrição das condições do imóvel.
                O LOCATÁRIO se compromete a devolver o imóvel nas mesmas condições, 
                salvo o desgaste natural decorrente do uso.
            </p>

            <h2>CLÁUSULA 11 – FORO</h2>
            <p>
                Fica eleito o foro da comarca de <span id="grifar"><strong>[cidade e estado]</strong></span> 
                para dirimir quaisquer dúvidas ou litígios oriundos deste contrato,
                renunciando as partes a qualquer outro, por mais privilegiado que seja.
            </p>

            <p style="margin-top: 10rem; text-align: center;">__________________________________</p>
            <p style="text-align: center;"><strong>Local e Data</strong></p>
            <p style="margin-top: 5rem; text-align: center;">__________________________________</p>
            <p style="text-align: center;"><strong>Assinatura do Locador</strong></p>
            <p style="margin-top: 5rem; text-align: center;">__________________________________</p>
            <p style="text-align: center;"><strong>Assinatura do Locatário</strong></p>
        </section>
    </main>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            document.getElementById('exportPDF').addEventListener("click", () => {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF("p", "mm", "a4");

                const margin = 25.5; 
                let y = margin;      

                const contrato = document.getElementById("contrato");
                const pageWidth = pdf.internal.pageSize.getWidth() - 2 * margin;

                pdf.setFont("times", "normal");

                function processElement(element) {
                    if (element.tagName === "H1") {
                        pdf.setFontSize(14);
                        pdf.setFont("times", "bold");

                        let title = element.innerText;
                        let splitTitle = pdf.splitTextToSize(title, pageWidth);
                        let titleHeight = splitTitle.length * 6;

                        if (y + titleHeight > pdf.internal.pageSize.getHeight() - margin) {
                            pdf.addPage();
                            y = margin;
                        }

                        let titleWidth = pdf.getTextWidth(title);
                        pdf.text(title, (pageWidth - titleWidth) / 2 + margin, y);
                        y += titleHeight + 5;
                    } else if (element.tagName === "H2") {
                        pdf.setFontSize(12);
                        pdf.setFont("times", "bold");

                        let title = element.innerText;
                        let splitTitle = pdf.splitTextToSize(title, pageWidth);
                        let titleHeight = splitTitle.length * 6;

                        if (y + titleHeight > pdf.internal.pageSize.getHeight() - margin) {
                            pdf.addPage();
                            y = margin;
                        }

                        pdf.text(splitTitle, margin, y); 
                        y += titleHeight + 5;
                    } else if (element.tagName === "P" || element.tagName === "LI") {
                        pdf.setFontSize(12);
                        pdf.setFont("times", "normal");

                        let text = element.innerText;
                        let splitText = pdf.splitTextToSize(text, pageWidth);
                        let textHeight = splitText.length * 6;

                        if (y + textHeight > pdf.internal.pageSize.getHeight() - margin) {
                            pdf.addPage();
                            y = margin;
                        }

                        pdf.text(splitText, margin, y); 
                        y += textHeight + 5;
                    } else if (element.tagName === "UL") {
                        pdf.setFontSize(12);
                        pdf.setFont("times", "normal");
                        
                        for (let li of element.children) {
                            let bulletText = `• ${li.innerText}`;
                            let splitBullet = pdf.splitTextToSize(bulletText, pageWidth);
                            let textHeight = splitBullet.length * 6;

                            if (y + textHeight > pdf.internal.pageSize.getHeight() - margin) {
                                pdf.addPage();
                                y = margin;
                            }

                            pdf.text(splitBullet, margin, y);
                            y += textHeight + 2;
                        }
                        return;
                    }
                }

                for (let el of contrato.children) {
                    processElement(el);
                }

                pdf.save("contrato.pdf");
            });
        });

        document.getElementById("exportDocx").addEventListener("click", () => {
            if (!window.docx) {
                alert("A biblioteca docx ainda não carregou. Tente novamente.");
                return;
            }

            const { Document, Packer, Paragraph, TextRun, AlignmentType, Numbering, LevelFormat } = window.docx;
            const contrato = document.getElementById("contrato");

            let children = [];
            let listCounter = 1; 

            contrato.childNodes.forEach(node => {
                if (node.nodeType === Node.ELEMENT_NODE) {
                    let textRuns = [new TextRun({ text: node.innerText })];
                    let paragraphProps = { spacing: { after: 200 } };

                    if (node.tagName === "H1") {
                        textRuns = [new TextRun({ text: node.innerText, bold: true, size: 28 })];
                        paragraphProps.alignment = AlignmentType.CENTER;
                    } else if (node.tagName === "H2") {
                        textRuns = [new TextRun({ text: node.innerText, bold: true, size: 24 })];
                        paragraphProps.alignment = AlignmentType.LEFT;
                    } else if (node.tagName === "P") {
                        textRuns = [new TextRun({ text: node.innerText, size: 24 })];
                        paragraphProps.alignment = AlignmentType.JUSTIFIED;
                    } else if (node.tagName === "UL") {
                        Array.from(node.children).forEach((li) => {
                            let listItemText = li.innerText;

                            children.push(new Paragraph({
                                children: [new TextRun({ text: listItemText, size: 24 })],
                                bullet: { level: 0 }                            
                            }));
                        });

                        return; 
                    }
                    children.push(new Paragraph({ children: textRuns, ...paragraphProps }));
                }
            });

            const doc = new Document({
                numbering: {
                    config: [{
                        reference: "numbered-list",
                        levels: [{
                            level: 0,
                            format: LevelFormat.DECIMAL,
                            text: "%1.",
                            alignment: AlignmentType.LEFT,
                        }]
                    }]
                },
                sections: [{
                    properties: {},
                    children
                }]
            });

            Packer.toBlob(doc).then(blob => {
                const link = document.createElement("a");
                link.href = URL.createObjectURL(blob);
                link.download = "contrato.docx";
                link.click();
            });
        });
    </script>
</body>

</html>